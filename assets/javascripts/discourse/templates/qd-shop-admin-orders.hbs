<div class="qd-shop-admin-orders-page">
  {{! é¡µé¢å¤´éƒ¨ }}
  <div class="qd-admin-orders-header">
    <div class="qd-admin-orders-title">
      <button class="back-btn" {{on "click" this.goBackToShop}}>
        <i class="fa fa-arrow-left"></i>
      </button>
      <h1>ğŸ› ï¸ è®¢å•ç®¡ç†</h1>
      <p class="qd-admin-orders-subtitle">ç®¡ç†æ‰€æœ‰ç”¨æˆ·çš„è´­ä¹°è®¢å•</p>
    </div>
    
    <div class="qd-admin-orders-actions">
      <button 
        class="btn btn-default refresh-btn {{if this.isLoading 'loading'}}" 
        {{on "click" this.refreshOrders}}
        disabled={{this.isLoading}}
      >
        <i class="fa fa-refresh {{if this.isLoading 'fa-spin'}}"></i>
        {{if this.isLoading "åˆ·æ–°ä¸­..." "åˆ·æ–°"}}
      </button>
    </div>
  </div>

  {{! ç»Ÿè®¡é¢æ¿ }}
  <div class="qd-admin-stats">
    <div class="stats-item">
      <span class="stats-label">æ€»è®¢å•æ•°</span>
      <span class="stats-value">{{this.totalOrders}}</span>
    </div>
    <div class="stats-item pending">
      <span class="stats-label">å¤„ç†ä¸­</span>
      <span class="stats-value">{{this.pendingOrders}}</span>
    </div>
    <div class="stats-item completed">
      <span class="stats-label">å·²å®Œæˆ</span>
      <span class="stats-value">{{this.completedOrders}}</span>
    </div>
    <div class="stats-item cancelled">
      <span class="stats-label">å·²å–æ¶ˆ</span>
      <span class="stats-value">{{this.cancelledOrders}}</span>
    </div>
  </div>

  {{! è®¢å•åˆ—è¡¨ }}
  <div class="qd-admin-orders-content">
    {{#if model.orders}}
      <div class="qd-admin-orders-list">
        {{#each model.orders as |order|}}
          <div class="qd-admin-order-card">
            <div class="order-header">
              <div class="order-id">
                <span class="order-label">è®¢å•å·:</span>
                <span class="order-number">#{{order.id}}</span>
              </div>
              <div class="order-status">
                <span class="status-badge {{this.getStatusClass order.status}}">
                  {{this.getStatusText order.status}}
                </span>
                <button 
                  class="btn btn-small update-status-btn" 
                  {{on "click" (fn this.showUpdateStatusModal order)}}
                >
                  <i class="fa fa-edit"></i>
                  æ›´æ–°çŠ¶æ€
                </button>
              </div>
            </div>
            
            <div class="order-body">
              <div class="user-info">
                <div class="user-avatar">
                  <img src="{{this.getUserAvatar order.user_avatar}}" alt="{{order.username}}">
                </div>
                <div class="user-details">
                  <h4 class="username">{{order.username}}</h4>
                  <span class="user-id">ID: {{order.user_id}}</span>
                </div>
              </div>
              
              <div class="product-info">
                <div class="product-icon">
                  <i class="fa {{order.product_icon}}"></i>
                </div>
                <div class="product-details">
                  <h3 class="product-name">{{order.product_name}}</h3>
                  {{#if order.product_description}}
                    <p class="product-description">{{order.product_description}}</p>
                  {{/if}}
                  <div class="product-meta">
                    <span class="quantity">æ•°é‡: {{order.quantity}}</span>
                    <span class="unit-price">å•ä»·: {{order.unit_price}} ç§¯åˆ†</span>
                  </div>
                </div>
              </div>
              
              <div class="order-summary">
                <div class="total-price">
                  <span class="price-label">æ€»è®¡</span>
                  <span class="price-value">{{order.total_price}} ç§¯åˆ†</span>
                </div>
              </div>
            </div>
            
            <div class="order-footer">
              <div class="order-time">
                <div class="time-item">
                  <i class="fa fa-clock-o"></i>
                  <span>åˆ›å»º: {{this.formatDate order.created_at}}</span>
                </div>
                {{#if order.updated_at}}
                  <div class="time-item">
                    <i class="fa fa-edit"></i>
                    <span>æ›´æ–°: {{this.formatDate order.updated_at}}</span>
                  </div>
                {{/if}}
              </div>
              
              {{#if order.notes}}
                <div class="order-notes">
                  <i class="fa fa-sticky-note-o"></i>
                  <span>{{order.notes}}</span>
                </div>
              {{/if}}
            </div>
          </div>
        {{/each}}
      </div>
      
      {{! åˆ†é¡µ }}
      {{#if (gt model.pagination.total_pages 1)}}
        <div class="qd-admin-pagination">
          <span class="pagination-info">
            ç¬¬ {{model.pagination.current_page}} é¡µï¼Œå…± {{model.pagination.total_pages}} é¡µ
          </span>
        </div>
      {{/if}}
      
    {{else}}
      <div class="qd-admin-orders-empty">
        <div class="empty-icon">
          <i class="fa fa-inbox"></i>
        </div>
        <h3>æš‚æ— è®¢å•</h3>
        <p>è¿˜æ²¡æœ‰ç”¨æˆ·è´­ä¹°å•†å“</p>
      </div>
    {{/if}}
  </div>
</div>

{{! çŠ¶æ€æ›´æ–°å¼¹çª— }}
{{#if this.showStatusModal}}
  <div class="qd-status-modal">
    <div class="qd-status-content">
      <h3>æ›´æ–°è®¢å•çŠ¶æ€</h3>
      
      <div class="order-info">
        <p><strong>è®¢å•å·:</strong> #{{this.selectedOrder.id}}</p>
        <p><strong>ç”¨æˆ·:</strong> {{this.selectedOrder.username}}</p>
        <p><strong>å•†å“:</strong> {{this.selectedOrder.product_name}}</p>
        <p><strong>å½“å‰çŠ¶æ€:</strong> {{this.getStatusText this.selectedOrder.status}}</p>
      </div>
      
      <div class="status-form">
        <label for="new-status">æ–°çŠ¶æ€:</label>
        <select id="new-status" {{on "change" (fn (mut this.newStatus) value="target.value")}}>
          <option value="pending" selected={{eq this.newStatus "pending"}}>å¤„ç†ä¸­</option>
          <option value="completed" selected={{eq this.newStatus "completed"}}>å·²å®Œæˆ</option>
          <option value="cancelled" selected={{eq this.newStatus "cancelled"}}>å·²å–æ¶ˆ</option>
        </select>
        
        <label for="admin-notes">ç®¡ç†å‘˜å¤‡æ³¨:</label>
        <textarea 
          id="admin-notes" 
          placeholder="å¯é€‰çš„ç®¡ç†å‘˜å¤‡æ³¨..."
          {{on "input" (fn (mut this.adminNotes) value="target.value")}}
        >{{this.adminNotes}}</textarea>
      </div>
      
      {{#if this.statusMessage}}
        <div class="status-message {{if (includes this.statusMessage 'æˆåŠŸ') 'success' 'error'}}">
          {{this.statusMessage}}
        </div>
      {{/if}}
      
      <div class="modal-buttons">
        <button 
          class="btn btn-default" 
          {{on "click" this.closeStatusModal}}
          disabled={{this.isLoading}}
        >
          å–æ¶ˆ
        </button>
        <button 
          class="btn btn-primary" 
          {{on "click" this.updateOrderStatus}}
          disabled={{this.isLoading}}
        >
          {{if this.isLoading "æ›´æ–°ä¸­..." "ç¡®è®¤æ›´æ–°"}}
        </button>
      </div>
    </div>
  </div>
{{/if}}