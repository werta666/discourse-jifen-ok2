<div class="qd-tp-container">
  <!-- å¤´éƒ¨åŒºåŸŸ -->
  <div class="header-section">
    <h2>ğŸ® ç”µç«èµ›äº‹æŠ•ç¥¨</h2>
    <div class="user-stats">
      {{#if this.model.isLoggedIn}}
        <span class="points">ğŸ’° ç§¯åˆ†: {{this.model.userBalance}}</span>
      {{else}}
        <span class="points">è¯·å…ˆç™»å½•</span>
      {{/if}}
      <button class="refresh-btn" {{on "click" this.refreshData}}>
        {{#if this.isLoading}}
          <span class="loading-spinner"></span>
        {{else}}
          ğŸ”„ åˆ·æ–°
        {{/if}}
      </button>
    </div>
  </div>

  <!-- èµ›äº‹åˆ—è¡¨ -->
  {{#if this.model.events.length}}
    <div class="events-grid">
      {{#each this.model.events as |event|}}
        <div class="event-card">
          <div class="event-header">
            <h3>{{event.title}}</h3>
            {{#if event.subtitle}}
              <p class="event-subtitle">{{event.subtitle}}</p>
            {{/if}}
            <span class="event-status {{event.status}}">
              {{#if (eq event.status "active")}}
                ğŸŸ¢ è¿›è¡Œä¸­
              {{else if (eq event.status "finished")}}
                ğŸ”´ å·²ç»“æŸ
              {{else}}
                ğŸŸ¡ å³å°†å¼€å§‹
              {{/if}}
            </span>
          </div>

          <div class="event-meta">
            <div class="event-time">
              <span>â°</span>
              <span>{{this.getTimeRemaining event.end_time}}</span>
            </div>
            <div class="total-bets">
              ğŸ“Š æ€»æŠ•æ³¨: {{event.total_votes}} äºº | ğŸ’° å¥–æ± : {{event.total_pool}}
            </div>
          </div>

          {{#if (eq event.status "active")}}
            <div class="betting-options">
              {{#each event.options as |option|}}
                <div 
                  class="betting-option {{if (eq this.selectedOption.id option.id) 'selected'}}"
                  {{on "click" (fn this.openBetModal event option)}}
                >
                  <div class="team-info">
                    <div class="team-logo">{{option.logo}}</div>
                    <div class="team-name">{{option.name}}</div>
                    <div class="team-odds">èµ”ç‡: {{option.odds}}</div>
                    <div class="team-stats">
                      <small>{{option.votes}} ç¥¨ | {{option.pool}} ç§¯åˆ†</small>
                    </div>
                  </div>
                </div>
              {{/each}}
            </div>
          {{else if (eq event.status "finished")}}
            <div class="betting-options">
              {{#each event.options as |option|}}
                <div class="betting-option disabled {{if option.winner 'winner'}}">
                  <div class="team-info">
                    <div class="team-logo">{{option.logo}}</div>
                    <div class="team-name">
                      {{option.name}}
                      {{#if option.winner}}ğŸ†{{/if}}
                    </div>
                    <div class="team-odds">èµ”ç‡: {{option.odds}}</div>
                    <div class="team-stats">
                      <small>{{option.votes}} ç¥¨ | {{option.pool}} ç§¯åˆ†</small>
                    </div>
                  </div>
                </div>
              {{/each}}
            </div>
          {{/if}}
        </div>
      {{/each}}
    </div>
  {{else}}
    <div class="empty-state">
      <div class="empty-icon">ğŸ®</div>
      <h3>æš‚æ— èµ›äº‹</h3>
      <p>å½“å‰æ²¡æœ‰å¯æŠ•æ³¨çš„ç”µç«èµ›äº‹ï¼Œè¯·ç¨åå†æ¥æŸ¥çœ‹</p>
    </div>
  {{/if}}
</div>

<!-- æŠ•æ³¨æ¨¡æ€æ¡† -->
{{#if this.showBetModal}}
  <div class="bet-modal-overlay" {{on "click" this.closeBetModal}}>
    <div class="bet-modal" {{on "click" this.stopPropagation}}>
      <div class="modal-header">
        <h3>ğŸ¯ ç¡®è®¤æŠ•æ³¨</h3>
        <button class="close-btn" {{on "click" this.closeBetModal}}>Ã—</button>
      </div>

      <div class="modal-content">
        <div class="bet-info">
          <div class="selected-team">
            {{this.selectedOption.logo}} {{this.selectedOption.name}}
          </div>
          <div class="odds-info">
            èµ”ç‡: {{this.selectedOption.odds}}
          </div>
          <div class="event-info">
            <small>{{this.selectedEvent.title}}</small>
          </div>
        </div>

        <div class="amount-input">
          <label>ğŸ’° æŠ•æ³¨é‡‘é¢</label>
          <input 
            type="number" 
            value={{this.betAmount}} 
            {{on "input" this.updateBetAmount}}
            placeholder="è¯·è¾“å…¥æŠ•æ³¨é‡‘é¢"
            min="1"
            max={{this.model.userBalance}}
          />
        </div>

        <div class="quick-amounts">
          <button {{on "click" (fn this.setQuickAmount 10)}}>10</button>
          <button {{on "click" (fn this.setQuickAmount 50)}}>50</button>
          <button {{on "click" (fn this.setQuickAmount 100)}}>100</button>
          <button {{on "click" (fn this.setQuickAmount 500)}}>500</button>
        </div>

        {{#if this.potentialWin}}
          <div class="potential-win">
            <div class="label">ğŸ† é¢„è®¡è·å¾—</div>
            <div class="amount">{{this.potentialWin}} ç§¯åˆ†</div>
          </div>
        {{/if}}

        <div class="balance-info">
          <small>ğŸ’³ å½“å‰ä½™é¢: {{this.model.userBalance}} ç§¯åˆ†</small>
        </div>
      </div>

      <div class="modal-actions">
        <button class="cancel-btn" {{on "click" this.closeBetModal}}>
          âŒ å–æ¶ˆ
        </button>
        <button 
          class="confirm-btn" 
          {{on "click" this.placeBet}}
          disabled={{this.isLoading}}
        >
          {{#if this.isLoading}}
            <span class="loading-spinner"></span>
            æŠ•æ³¨ä¸­...
          {{else}}
            âœ… ç¡®è®¤æŠ•æ³¨
          {{/if}}
        </button>
      </div>
    </div>
  </div>
{{/if}}